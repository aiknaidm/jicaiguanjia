<style>
/* pages/qb-jiaoyijilu/index.wxss */

.container {
  font-size: 30rpx;
}

.jy-top {
  background-color: #f2f2f2;
  padding: 40rpx;
  display: flex;
  justify-content: space-between;
}

.jy-top-img image {
  width: 70rpx;
  height: 70rpx;
  margin-left: 20rpx;
}

.jy-top-img {
  display: flex;
}

.jy-top-money {
  color: #f90;
  line-height: 46rpx;
}

.jy-content {
  display: flex;
  padding: 40rpx;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #eee;
}

.jy-content-left {
  font-size: 28rpx;
  line-height: 35rpx;
}

.jy-content-left view:first-child {
  line-height: 65rpx;
  font-size: 32rpx;
}

.jy-content-price {
  color: #f90;
}

.jy-content-right {
  font-size: 40rpx;
   color: #f90;
 
}
.jy-content-1{
 color: #f90;
}
.jy-content-2{
 color: #0095e5;
}
.tishi1 {
  text-align: center;
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0px;
  top: 0px;
  background-color: rgba(0, 0, 0, 0.4);
  z-index: 10;
  display: flex;
  justify-content: center;
  align-items: center;
  /* display: none; */
}

.tishi1-1 {
  width: 80%;
  height: 360rpx;
  margin: auto;
  background-color: #fafafa;
  display: flex;
  flex-direction: column;
  /* padding: 20rpx 20rpx 0 20rpx; */
}

.content {
  display: flex;
  flex: 1;
  align-items: center;
}

.content button {
  font-size: 30rpx;
  height: 88rpx;
  line-height: 88rpx;
  color: #747474;
}

.title {
  line-height: 88rpx;
  border-bottom: 1px solid #eee;
  margin-bottom: 10rpx;
}

.quxiao {
  line-height: 88rpx;
  background-color: #fff;
  margin-top: 20rpx;
}

.content button.active {
  background-color: #50b569;
  color: #fff;
}

/*  加载更多   */

.weui-loading {
  margin: 0 5px;
  width: 20px;
  height: 20px;
  display: inline-block;
  vertical-align: middle;
  -webkit-animation: weuiLoading 1s steps(12, end) infinite;
  animation: weuiLoading 1s steps(12, end) infinite;
  background: transparent url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgxMDB2MTAwSDB6Ii8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTlFOUU5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTMwKSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iIzk4OTY5NyIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgzMCAxMDUuOTggNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjOUI5OTlBIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDYwIDc1Ljk4IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0EzQTFBMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA2NSA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNBQkE5QUEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDU4LjY2IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0IyQjJCMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgxNTAgNTQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjQkFCOEI5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDE4MCA1MCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDMkMwQzEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1MCA0NS45OCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDQkNCQ0IiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTEyMCA0MS4zNCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNEMkQyRDIiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0RBREFEQSIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgtNjAgMjQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTJFMkUyIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKC0zMCAtNS45OCA2NSkiLz48L3N2Zz4=) no-repeat;
  background-size: 100%;
}

.weui-loadmore {
  width: 65%;
  margin: 1.5em auto;
  line-height: 1.6em;
  font-size: 14px;
  text-align: center;
}

.weui-loadmore_tips {
  display: inline-block;
  vertical-align: middle;
}

</style>

<template>
  <!--pages/qb-jiaoyijilu/index.wxml-->
<view class='container'>
  <view class='jy-top'>
    <view class='jy-top-left'>
      <view class='jy-top-date'>{{shijian}}</view>
      <!-- <view class='jy-top-money'>交易额￥{{zonge}}</view> -->
    </view>

    <view class='jy-top-img'>
      <!-- <image src='/images/u85.png' bindtap='openSelect'></image> -->
      <picker mode="date" value="{{date}}" fields="month" bindchange="bindDateChange">
        <view class="picker">
          <image src='/images/u87.png'></image>
        </view>
      </picker>
    </view>
  </view>

  <view wx:for-items="{{moneyList}}" wx:key="{{index}}">
    <view bindtap="moneyDetail" data-id='{{item.id}}' data-userid='{{item.user_id}}'>
      <view class='jy-content'>

        <view class='jy-content-right'>
         -{{item.jine}}
          <view class='jy-content-left' style='color:black'>
            <view>{{item.shouzhi}}</view>
          </view>
        </view>
        <view class='jy-content-left'>
          <view>时间：{{item.pay_time}}</view>
        </view>

      </view>
    </view>
  </view>

  <view class="weui-loadmore" wx:if="{{isMoreData}}">
    <view class="weui-loading"></view>
    <view class="weui-loadmore_tips">正在加载</view>
  </view>

</view>
</template>
<script>
import wepy from 'wepy';
import statusTap from '../../components/statusTap';
import newapi from '../../API/newapi';
import util from '../../utils/index';
import popup from '../../components/popup';
export default class newslist extends wepy.page {
  config = {
    navigationBarTitleText: '提现'
  };
  components = { statusTap, popup };
  data = {
  moneyList:[],
  isMoreData:true,
  shijian:''
  };
  computed = {};
  methods = {
     bindDateChange: function (e) {
    console.log('picker发送选择改变，携带值为', e.detail.value)

      this.shijian= e.detail.value,
       this.page= 1,
       this.zonge= 0
  
    this.getMoneyData();
  },
  };
  events = {};
  async getList(id) {}
  // 分享列表
  async getMoneyData(status) {
      util.showLoading();
    let data = {
        suppliers_id:this.suppliers_id,
        shijian:this.shijian,
        page:this.page
    };
    let res = await newapi.txjl(data);
    util.hideLoading();
    res.data.data.data.forEach((item,index)=>{
        res.data.data.data[index].pay_time=util.formatDate1(new Date(item.pay_time)/1000);
    })
    if (res.data.code == 0) {
      if (this.page == 1) {
        this.isMoreData = true;
        this.moneyList = res.data.data.data;
        // this.zonge=
      } else {
          this.moneyList.push(...res.data.data.data);
      }
      if (res.data.data.data.length < 10) this.isMoreData = false;
      this.$apply();
    } else {
      util.showToast(res.data.message);
    }
  }

  async onLoad(option) {
  var suppliers_id = this.$parent.globalData.suppliers_id?this.$parent.globalData.suppliers_id:""
      var yizhanInfo =  this.$parent.globalData.yizhanInfo? this.$parent.globalData.yizhanInfo:await this.$parent.getYizhanInfo(suppliers_id);
      this.suppliers_id = suppliers_id==""?yizhanInfo.suppliers_id:suppliers_id;
 
    this.page=1;
    this.isMoreData=true;
    this.shijian = util.formatDate1(new Date()/1000);
       this.getMoneyData();
  }
   onReachBottom() {
      if (this.isMoreData) {
    
        this.page = this.page + 1;
        this.getMoneyData();
      }
    }
}
</script>
