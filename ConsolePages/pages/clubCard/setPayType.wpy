<style lang="less">
.listBox {
  height: 90rpx;
  line-height: 90rpx;
  border-bottom: 1px solid#e4e4e4;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 40rpx;
}
.listBox3 .listOption {
  width: auto;
}
.goods_title {
  padding: 20rpx 40rpx;
}
.listOptionImages {
  width: 100rpx;
}
.a-gooods {
  width: 100%;
  /* width: 100%; */
  background-color: #fff;
  overflow: hidden;
  padding-bottom: 20rpx;
  border-top: 8rpx solid #f0f0f0;
}
.a-gooods-title {
  padding: 20rpx 40rpx;
  border-bottom: 1px solid #f0f0f0;
} // .a-goods-conts {
//   display: flex;
//   justify-content: space-between;
//   /* padding-left: 30rpx; */
//   width: 100%;
//   box-sizing: border-box;
//   transition: margin-left 0.2s ease-in-out;
//   background: url(https://cdn.it120.cc/images/weappshop/gou.png) no-repeat 30rpx
//     center;
//   background-size: 40rpx auto;
// }
.goods-info {
  display: flex;
  justify-content: space-between;
  padding: 30rpx 0 0 30rpx;
  flex: 11;
  box-sizing: border-box;
  position: relative;
  /* align-items: center; */
}
.goods-info .img-box {
  width: 160rpx;
  height: 160rpx;
  overflow: hidden;
  margin-right: 20rpx;
  /* background-color: #d8d8d8; */
}
.goods-info .text-box {
  flex: 1;
  position: relative;
  font-size: 30rpx;
  justify-content: space-around;
  /* display: flex; */
  flex-direction: column;
  margin-right: 20rpx;
  padding-bottom: 30rpx;
}
.goods-info .img-box {
  margin: 0;
}
.goods-info .text-box {
  display: flex;
  justify-content: space-between;
  padding: 0 20rpx;
}
.goods-info .text-box .goods-num {
  display: flex;
  justify-content: space-between;
  font-size: 26rpx;
}
.goods-info .text-box .goods-title {
  width: 100%;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
} // .a-goods-conts.active {
//   background: url(data:image/png;base64,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)
//     no-repeat 30rpx center;
//   background-size: 40rpx auto;
// }
</style>
<template>
    <view class='container'>
        <view class="listBox listBox3">
            <view class="listOption">设置为全部商品可用会员卡支付</view>
            <view class="listOptionImages goodsDetail">
                <switch checked="{{is_hdky}}" bindchange="switch1Change" color="#e50012" />
                <!-- <radio-group class="radio-group" @tap="radioChange">
                                                    <radio value="{{item.name}}" checked="{{is_hdky}}" />
                                                </radio-group> -->
            </view>
        </view>
        <view></view>
        <view class="goods_list" wx:if="{{is_hdky}}">
            <view class="goods_title">
                不支持会员卡商品列表
            </view>
            <view class="a-gooods" wx:for="{{list}}" wx:key="{{index}}">
                <!-- wx:for="{{list}}" wx:key="{{index}}" -->
                <view class="a-goods-conts {{item.active? 'active':''}}" @tap.stop="toGoodDetailsTap({{item.goods_id}},{{item.goods_name}},{{index}})">
                    <view class="goods-info">
                        <view class="img-box">
                            <image src="http://maijia.jicaizx.com/{{item.original_img}}" class="img" wx:if="{{item.original_img1==''}}" />
                            <image src="{{item.original_img1}}" class="img" wx:else/>
                        </view>
                        <view class="text-box">
                            <view class="goods-title" data-id="{{item.goods_id}}">{{item.goods_name}}
                            </view>
                            <view class='goods-num'>
                                <text class='red'>价格：￥{{item.shop_price}}</text>
                            </view>
                            <view class='goods-num'>
                                <text class='green'>库存：{{item.goods_number}}</text>
                                <text class=''>总销量：{{item.salenum}}</text>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <view class="goods_list" wx:else>
            <view class="goods_title">
                支持会员卡商品列表
            </view>
            <view class="a-gooods" wx:for="{{list}}" wx:key="{{index}}">
                <!-- wx:for="{{list}}" wx:key="{{index}}" -->
                <view class="a-goods-conts {{item.active? 'active':''}}" @tap.stop="toGoodDetailsTap({{item.goods_id}},{{item.goods_name}},{{index}})">
                    <view class="goods-info">
                        <view class="img-box">
                            <image src="http://maijia.jicaizx.com/{{item.original_img}}" class="img" wx:if="{{item.original_img1==''}}" />
                            <image src="{{item.original_img1}}" class="img" wx:else/>
                        </view>
                        <view class="text-box">
                            <view class="goods-title" data-id="{{item.goods_id}}">{{item.goods_name}}
                            </view>
                            <view class='goods-num'>
                                <text class='red'>价格：￥{{item.shop_price}}</text>
                            </view>
                            <view class='goods-num'>
                                <text class='green'>库存：{{item.goods_number}}</text>
                                <text class=''>总销量：{{item.salenum}}</text>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <view wx:if="{{list.length==0}}">
            <noOrder text="暂无商品"></noOrder>
        </view>
    </view>
</template>

<script>
import wepy from 'wepy';
import api from '../../../API/api';
import newapi from '../../../API/newapi';
import util from '../../../utils/index';
import noOrder from '../../../components/noOrder';
export default class newslist extends wepy.page {
  config = {
    navigationBarTitleText: '会员卡设置'
  };
  components = {
    noOrder
  };
  data = {
    is_hdky: true,
    list: []
  };
  computed = {};
  methods = {
    toGoodDetailsTap(id) {
      wx.navigateTo({
        url: '../addGoodsInfo?id=' + id
      });
    },
    async switch1Change(e) {
      if (this.is_hdky)
        var msg =
          '你确定要改为全部商品不可用会员卡支付么？这样你原来设置的商品信息将被修改。';
      else
        var msg =
          '你确定要改为全部商品可用会员卡支付么？这样你原来设置的商品信息将被修改。';
      this.is_hdky = e.detail.value;
      var res = await wepy.showModal({
        title: '提示', //提示的标题,
        content: msg, //提示的内容,
        showCancel: true, //是否显示取消按钮,
        cancelText: '取消', //取消按钮的文字，默认为取消，最多 4 个字符,
        cancelColor: '#000000', //取消按钮的文字颜色,
        confirmText: '确定', //确定按钮的文字，默认为取消，最多 4 个字符,
        confirmColor: '#3CC51F' //确定按钮的文字颜色,
      });
      if (res.confirm) {
        var that = this;
        this.is_hdky = e.detail.value;
        this.$parent.globalData.yizhanInfo.hdky = this.is_hdky ? 1 : 0;
        this.getCardSetinfo(this.suppliers_id, this.is_hdky ? 1 : 0, function(
          res
        ) {
          that.getGoodsList(that.suppliers_id, that.is_hdky ? 0 : 1, 1);
        });
        this.$apply();
      } else if (res.cancel) {
        this.is_hdky = !e.detail.value;
        this.$apply();
      }
    }
  };
  events = {};
  async getCardSetinfo(suppliers_id, hdky, callback) {
    let data = {
      suppliers_id,
      hdky
    };
    var res = await newapi.suppliers_hdky(data);
    console.log('suppliers_hdky res', res);
    if (res.data.code == 0) {
      wx.showToast({
        title: '修改成功', //提示的内容,
        icon: 'none', //图标,
        duration: 2000, //延迟时间,
        mask: true, //显示透明蒙层，防止触摸穿透,
        success: res => {}
      });
      if (callback) callback();
    } else {
      wx.showToast({
        title: res.data.message, //提示的内容,
        icon: 'none', //图标,
        duration: 2000, //延迟时间,
        mask: true, //显示透明蒙层，防止触摸穿透,
        success: res => {}
      });
    }
  }
  async getGoodsList(suppliers_id, hdky, page) {
    wx.showLoading({
      title: '加载中', //提示的内容,
      mask: true, //显示透明蒙层，防止触摸穿透,
      success: res => {}
    });
    let data = {
      suppliers_id,
      hdky,
      page
    };
    var res = await newapi.hd_goods_list(data);
    console.log('getGoodsList', res);
    wx.hideLoading();
    if (res.data.code == 0) {
      if (this.page == 1) {
        this.isMoreData = true;
        this.list = res.data.data.data;
      } else this.list.push(...res.data.data.data);
      if (res.data.data.data.length < 10) this.isMoreData = false;
      this.$apply();
    } else {
      wx.showToast({
        title: res.data.message, //提示的内容,
        icon: 'none', //图标,
        duration: 2000, //延迟时间,
        mask: true, //显示透明蒙层，防止触摸穿透,
        success: res => {}
      });
    }
  }
  onReachBottom() {
    if (this.isMoreData) {
      this.page = this.page + 1;
      this.getGoodsList(this.suppliers_id, this.is_hdky ? 0 : 1, this.page);
    }
  }
  async onShow() {
    try {
      this.page = 1;
      this.user_id = await this.$parent.loginInfo();
      this.suppliers_id = this.$parent.globalData.suppliers_id
        ? this.$parent.globalData.suppliers_id
        : (await this.$parent.getYizhanInfo(this.user_id)).suppliers_id;
      this.is_hdky =
        this.$parent.globalData.yizhanInfo.hdky == 1 ? true : false;
      if (this.user_id == '' || this.suppliers_id == '') {
        wx.showToast({
          title: '登录失败', //提示的内容,
          icon: 'none', //图标,
          duration: 1000, //延迟时间,
          mask: true, //显示透明蒙层，防止触摸穿透,
          success: res => {
            wx.redirectTo({
              url: '/ConsolePages/pages/index'
            });
          }
        });
      }
      this.getGoodsList(this.suppliers_id, this.is_hdky ? 0 : 1, this.page);
      this.$apply();
    } catch (error) {
      wx.showToast({
        title: '登录失败', //提示的内容,
        icon: 'none', //图标,
        duration: 1000, //延迟时间,
        mask: true, //显示透明蒙层，防止触摸穿透,
        success: res => {
          wx.redirectTo({
            url: '/ConsolePages/pages/index'
          });
        }
      });
    }
  }
}
</script>
